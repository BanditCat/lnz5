Attempt number 2 at Lamping's algorithm, now in Haskell!
